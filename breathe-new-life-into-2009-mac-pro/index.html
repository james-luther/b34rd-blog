<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Breathe New Life into 2009 Mac Pro  | b34rd</title><meta name="gridsome:hash" content="92a90b9266085ce96d20d6cef9819ea072252d0c"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Taking an old Mac Pro from 2009 and repurposing with Arch and ZFS"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Breathe New Life into 2009 Mac Pro"><meta data-vue-tag="ssr" property="og:description" content="Taking an old Mac Pro from 2009 and repurposing with Arch and ZFS"><meta data-vue-tag="ssr" property="og:url" content="https://b34rd.tech/breathe-new-life-into-2009-mac-pro/"><meta data-vue-tag="ssr" property="article:published_time" content="2025-09-03"><meta data-vue-tag="ssr" property="og:image" content="https://miro.medium.com/max/1400/1*AV6cNtyNeiuQBfkxau3Z0A.jpeg"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Breathe New Life into 2009 Mac Pro"><meta data-vue-tag="ssr" name="twitter:description" content="Taking an old Mac Pro from 2009 and repurposing with Arch and ZFS"><meta data-vue-tag="ssr" name="twitter:site" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:creator" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:image" content="https://miro.medium.com/max/1400/1*AV6cNtyNeiuQBfkxau3Z0A.jpeg"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.56b5f3de807ec30e6680f6f2542ba6b9.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700%7CCardo"><link data-vue-tag="ssr" rel="stylesheet" href="https://lab.subinsb.com/projects/francium/cryptodonate/css/cryptodonate.css"><link rel="preload" href="/assets/css/8.styles.730b85d8.css" as="style"><link rel="preload" href="/assets/js/app.49918c16.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.e0d89e50.js" as="script"><link rel="prefetch" href="/assets/js/10.76774a38.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.91110cbc.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.b657e00c.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.2791c006.js"><link rel="prefetch" href="/assets/js/page--src--templates--author-vue.1574b699.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.f9245811.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue~page--src--templates--author-vue~page--src--templates--post-vue~~a0fae544.402a1eb1.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--post-vue.7409c761.js"><link rel="stylesheet" href="/assets/css/8.styles.730b85d8.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased font-serif" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%20font-serif%22%7D%7D">
    <div data-server-rendered="true" id="app"><main><header><div class="post-cover overflow-hidden relative max-h-cover"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl text-center px-6 absolute z-10 mx-auto bottom-0 inset-x-0 pb-16"><div class="m-auto"><p class="text-white text-xs mb-2 uppercase">7 min read</p><h1 class="text-3xl sm:text-5xl font-sans font-bold leading-tight mb-2 text-white">Breathe New Life into 2009 Mac Pro</h1><p class="text-white"><span><a href="/author/b34rd/" class="text-white capitalize border-b border-transparent hover:border-white transition-colors duration-300">B34rd</a> •
          </span><time datetime="2018-10-04 00:00:00" class="capitalize">04 October, 2018</time></p></div></div><!----></div><nav class="absolute top-0 left-0 z-20 mt-6 ml-6"><a href="/" class="text-sm border opacity-75 hover:opacity-100 rounded-full px-4 py-2 transition-opacity duration-300 active text-white border-white">← Home</a></nav></header><article class="max-w-xl md:max-w-2xl xl:max-w-3xl mx-auto px-6 sm:px-12 pt-16"><div role="alert" class="leading-normal p-4 md:mx-6 mb-12 bg-orange-100 border-l-4 border-orange-500 text-orange-900">
        This post is over a year old, some of this information may be out of date.
      </div><div class="markdown text-lg leading-normal text-gray-700 pb-10"><p>The Mac Pro circa 2009 is an amazing machine. The case is too damn beautiful to not show off and to be honest, the hardware isn’t a slouch either! It was and is a desktop server, with the dual Xeon processors from Intel and up to 128 GB of RAM (after you update the firmware) the machine can go a long way for a LONG time. I originally purchased this for development. At the time I was doing a LOT of mobile research on iOS and MacOS in general. The common denominator for testing and developing was the need for Apple hardware. The price tag in 2009 wasn’t too bad either, for $2500 I was able to score an Apple Display and the Mac Pro with an ATI Radeon HD 5770, Dual 2.26 Quad Core Xeons, and 16 GB of RAM. Even at 2009 prices, that’s a steal!</p>
<p>For easily two years this machine was a monster at every task I threw at it. Once I moved on to more Android-based security research I found MacOS was severely lacking. It was great for development but not for much else I did. This drove me to install Linux. I went with OpenSuSE because of the stability and how developer friendly it has always been (my opinion has since changed as I’m a die-hard Arch guy these days but that’s not the point here). Things were going great and research was rocking! Moving on another year or two life struck and kids happened. I was no longer able to spend evenings researching and the computer sat which brings me to today, 2018. I have a 9 (more like 10) year old computer that has the potential for new life. Here’s where we start…</p>
<p>My plan is to install Arch and make this beast into a KVM server. I’m going to upgrade the RAM to 128GB and host virtual machines for Node-Red, Web services, Motion, Home Assistant, Plex, NextCloud, and probably make one for a NAS, and possibly a few others. Let’s get started…</p>
<p>First, we need to get a copy of Arch. Head over to archlinux.org/download and grab a copy of the latest iso.</p>
<p><img src="https://miro.medium.com/max/1400/1*49sHvnr4p0Vy32d0Rl5IYA.png" alt="alt text" title="Arch Linux Download Page"></p>
<p>Make sure after you’ve downloaded you verify the hash.</p>
<p><img src="https://miro.medium.com/max/1400/1*2Ii7C0vqlMGjG8yV6u56MQ.png" alt="alt text"></p>
<p>Now we can either burn the iso to a disk or copy to flash drive. I prefer the flash route.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># dd if=/path/to/archlinux.iso of=/dev/my/usb/device bs=4M.</span></span></code></pre>
<p>Upon completion, plug into the Mac, hold the option key, and boot up!</p>
<p><img src="https://miro.medium.com/max/1400/1*mrWs53QTngfpwNqlJy2shw.jpeg" alt="alt text" title="Hold Option Key while Booting"></p>
<p>It may take a bit for the screen to display but eventually, you will get some boot options:</p>
<p><img src="https://miro.medium.com/max/1400/1*IngJM5tr0MnAaAVHEQleEw.jpeg" alt="alt text" title="Boot Options"></p>
<p>Make sure you select the disc or the USB device you loaded your Arch iso onto. From here we are brought to a root terminal and can begin our install. For those who have never used Arch Linux in the past, the wiki is amazing. It is probably the BEST documented of any distribution of Linux and will help you in every way. Based on what you want to accomplish, the wiki will guide you through the remainder of the install. You can see it here: <a href="https://wiki.archlinux.org/index.php/installation_guide" target="_blank" rel="nofollow noopener noreferrer">https://wiki.archlinux.org/index.php/installation_guide</a>.</p>
<p>Now, we have network connectivity and have set our timezone. Time for us to get started. Since we’re going to install an LVM RAID, we need to turn on smartctl for our devices. Just open up your favorite editor (I prefer vim) and edit /etc/smartd.conf. I added the following lines for my devices:</p>
<p><img src="https://miro.medium.com/max/1400/1*Hmnl_3_YCxZwLhlMKUpFmA.png" alt="alt text" title="Adding devices to smartd"></p>
<p>Time to partition and set up our RAID. Depending on your version of Arch and fdisk, it may be different and since these drives have been used in the past, I’m just going to delete all partitions and set them up as Linux filesystem type. We need to make sure to create a ~200MB partition for EFI. When we make the EFI partition, set the type to 1, EFI. After this is created, execute “fdisk /dev/sdx” for your device and delete partitions (minus your EFI partition), create a new primary partition, and set the partition type, then finally write the changes. You will need to do this for every device you are adding to your LVM RAID.</p>
<p><img src="https://miro.medium.com/max/1470/1*9oh7iRJerbkncyNTOdVM9w.png" alt="alt text" title="Creating our EFI filesystem"></p>
<p>Here is where I start doing things a little differently than the install wiki. Now, I use LVM on the array to setup volume groups… From there, we install our base system and continue. To do this we run</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># pvcreate /dev/sdx, vgcreate VolGroup00 /dev/sdx. </span></span></code></pre>
<p>We will then verify everything with vgdisplay. After verifying we create our logical volume as raid 5 and use all the space available.</p>
<p><img src="https://miro.medium.com/max/552/1*SC0hi8TdBwndc-5NFemSzA.png" alt="alt text" title="vgdisplay output"></p>
<p><img src="https://miro.medium.com/max/552/1*ZFBV88S9LjDhly5ATd2ruA.png" alt="alt text" title="lvcreate"></p>
<p><img src="https://miro.medium.com/max/1400/1*Hsz-w97H7_ywhpk3aJSMHA.png" alt="alt text" title="lvdisplay"></p>
<p>From here we mount everything and run pacstrap with our base package selection. First we mount our arch-root to /mnt and our EFI to /mnt/boot. This is accomplished by executing:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># mount /dev/VolGroup00/arch-root /mnt</span></span>
<span class="line"><span style="color: #C2C3C5"># mkdir /mnt/boot</span></span>
<span class="line"><span style="color: #C2C3C5"># mount /dev/sda1 /mnt/boot</span></span></code></pre>
<p>We need to run pacstrap to get our base installed. You can add any package groups along with this command but I prefer to just install the base and then select individual packages with pacman in chroot step.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># pacstrap /mnt base </span></span></code></pre>
<p><img src="https://miro.medium.com/max/1400/1*1pE4Lm2kxW8ne6LqfC5evQ.png" alt="alt text" title="pacstrap installing base"></p>
<p>Once complete, we generate our fstab.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># genfstab -U /mnt &gt;&gt; /mnt/etc/fstab’. </span></span></code></pre>
<p>Now we go into our chroot and finish up.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># arch-chroot /mnt</span></span></code></pre>
<p>We set our timezone, run hwclock, set locale, specify LANG and keymap. Then we configure networking and install our bootloader. These steps don’t differ from the Arch installation wiki until it comes to bootloader.</p>
<p>Since this is a Mac we need to install intel-ucode package. This package is microcode for the processor. The BIOS updates will sort this out for you but, we aren’t able to update our bios. This is super important for us especially after spectre and meltdown updates were released.</p>
<p><img src="https://miro.medium.com/max/1400/1*XO3wWmU94kBYtkXXEcAqYg.png" alt="alt text" title="install of intel-ucode package"></p>
<p>Let’s go ahead and install all the KVM packages and requirements. We need to verify the kernel installed supports virtualization. We can check with:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># lsmod | grep kvm</span></span>
<span class="line"><span style="color: #C2C3C5"># lsmod | grep virtio</span></span>
<span class="line"><span style="color: #C2C3C5"># zgrep VIRTIO /proc/config.gz </span></span></code></pre>
<p><img src="https://miro.medium.com/max/1400/1*BIsyJYXnIzNGoeGAcawLKQ.png" alt="alt text" title="checking kvm status"></p>
<p>From here we need to install the qemu package and libvirt package. I’m going with qemu-headless since this machine is going to run without a display and be managed remotely.</p>
<p><img src="https://miro.medium.com/max/1400/1*R2g6T7zVqMoKGUwenaE4mA.png" alt="alt text" title="qemu installation"></p>
<p>Once complete you will see a few additional packages suggested. If you feel the need for them, go for it. It all depends on your system. I installed samba as well as the qemu extras.</p>
<p><img src="https://miro.medium.com/max/1400/1*GhGZvA36wVIp0SbLhBlM8g.png" alt="alt text" title="qemu extras"></p>
<p>The last thing I’m going to do is create a general user and setup sshd. To add my user, run:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># useradd -m -g users -G wheel,storage,power -s /bin/bash username</span></span>
<span class="line"><span style="color: #C2C3C5"># passwd username</span></span>
<span class="line"><span style="color: #C2C3C5"># pacman -S sudo</span></span>
<span class="line"><span style="color: #C2C3C5"># vi /etc/sudoers</span></span>
<span class="line"><span style="color: #C2C3C5"># uncomment the line below:</span></span>
<span class="line"><span style="color: #24292EFF">%wheel ALL=(ALL) ALL</span></span></code></pre>
<p>Next, we need to install openssh.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># pacman -S openssh </span></span>
<span class="line"><span style="color: #24292EFF"> - Next we edit our sshd config</span></span>
<span class="line"><span style="color: #C2C3C5"># vi /etc/ssh/sshd_config</span></span></code></pre>
<p>Here there are only a few things we need to specify, our listen address, listen port, users allowed, and to disable root login.</p>
<p>After we make our edits we enable the service…</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># systemctl enable sshd.service</span></span></code></pre>
<p><img src="https://miro.medium.com/max/552/1*OxWwK3vgM0liljAhMbvG0w.png" alt="alt text" title="install openssh"></p>
<p><img src="https://miro.medium.com/max/552/1*wbFE_ECx8ktNIgjNboSW0w.png" alt="alt text" title="uncomment listen port and address"></p>
<p><img src="https://miro.medium.com/max/1400/1*HHIZjZii-Xps2v0bcGMoww.png" alt="alt text" title="specify users and disable root in sshd"></p>
<p>Now that we’ve finished all of this let’s setup the ramfs and our bootloader.</p>
<p>To begin we need to add some lvm items to /etc/mkinitcpio.conf.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># vi /etc/mkinitcpio.conf</span></span>
<span class="line"><span style="color: #24292EFF"> -- We need to add systemd and sd-lvm2 to the HOOKS section --</span></span>
<span class="line"><span style="color: #24292EFF"> -- We also need to add dm-raid raid0 raid1 raid10 raid456 to the MODULES section --</span></span></code></pre>
<p><img src="https://miro.medium.com/max/1400/1*Xfg1uI5EpHAaWL2fT00hHg.png" alt="alt text" title="adding items to hooks"></p>
<p>Once we save we can generate run:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># mkinitcpio -p linux</span></span></code></pre>
<p>Lastly, we install our systemd bootloader and configure it. This is done with two commands:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span class="line"><span style="color: #C2C3C5"># bootctl --path=/boot install</span></span>
<span class="line"><span style="color: #C2C3C5"># bootctl --path=/boot update</span></span></code></pre>
<p>Reboot and enjoy!</p>
<p>Arch can be a bit intense for an install but it is well worth it when finished.</p>
<p>References:
S.M.A.R.T. - ArchWiki
S.M.A.R.T. (Self-Monitoring, Analysis, and Reporting Technology) is a supplementary component built into many modern…
wiki.archlinux.org
Installation guide - ArchWiki
This document is a guide for installing Arch Linux from the live system booted with the official installation image…
wiki.archlinux.org
LVM - ArchWiki
Virtual partitions allow addition and removal without worry of whether you have enough contiguous space on a particular…
wiki.archlinux.org
GRUB - ArchWiki
GRUB (GRand Unified Bootloader) is a multi-boot loader. It is derived from PUPA which was a research project to develop…
wiki.archlinux.org
Microcode - ArchWiki
Processor manufacturers release stability and security updates to the processor microcode. While microcode can be…
wiki.archlinux.org
EFI system partition - ArchWiki
According to a Microsoft note[2], the minimum size for the EFI system partition (ESP) would be 100 MiB, though this is…
wiki.archlinux.org
Meltdown and Spectre
Meltdown and Spectre exploit critical vulnerabilities in modern processors. These hardware vulnerabilities allow…
meltdownattack.com
KVM - ArchWiki
KVM, Kernel-based Virtual Machine, is a hypervisor built into the Linux kernel. It is similar to Xen in purpose but…
wiki.archlinux.org
QEMU - ArchWiki
When used as a machine emulator, QEMU can run OSes and programs made for one machine (e.g. an ARM board) on a different…
wiki.archlinux.org</p>
</div><footer class="flex flex-wrap pb-10 sm:pb-16"><div><a href="/tag/arch/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
            arch
          </a><a href="/tag/mac%20pro/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
            mac pro
          </a><a href="/tag/zfs/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
            zfs
          </a></div><div class="flex flex-wrap items-center justify-center sm:justify-left border-t border-b border-gray-300 w-full mt-10 py-10 sm:px-16"><figure class="px-2 mb-1 sm:mb-0 w-full sm:w-1/5 flex justify-center"><a href="/author/b34rd/"><img src="/images/authors/b34rd.png" alt="b34rd" width="100" class="rounded-full p-4 sm:p-0"></a></figure><div class="px-4 sm:w-4/5 text-center sm:text-left"><h4 class="font-sans font-bold text-lg sm:text-xl mb-2 sm:mb-4"><a href="/author/b34rd/" class="text-black hover:text-gray-600 capitalize border-b-2 border-transparent transition-colors duration-300">
                B34rd</a></h4><p class="leading-normal"><a href="/author/b34rd/" class="text-blue-500 hover:text-blue-400 transition-colors duration-300">See all posts by
                B34rd →</a></p><p><a href="https://www.buymeacoffee.com/b34rd" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height:60px !important;width:217px !important;"></a></p><table><tr><td id="btc"><button class="cryptodonate-btn">Donate<img src="data:image/png;base64,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"></button></td><td id="eth"><button class="cryptodonate-btn">Donate<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAOwAAADsAEnxA+tAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABAxJREFUWIW9l19oW3UUx7+/u9ze3PRml/QPNa5bpaldMdgWklawXRFnFX0RJj7MMUEcRRAFg8kmZTUwRBeTO7YJ+iB9KYhrIUIVLOJLIWkR2jLXgdDEljSU2JZCRpNmSZN7fLB2seYmWfrnPJ7zPed8OPd3f3+OYR/mcrkGUqmUORaLLVRag6s0UVEUsaamZojjuK9sNpvhyAFyudwnOp3uSQBNjDHXkQIoitLCGHPmua50d3e3HhlALpe7CUCf5xKI6NaRAHi93nOMsdf2+onoFbvd/vqhAiiKIgLwFZHcam9vrz40ACK6CuCpIpJTgiBcORQAj8fzNBE5SumIyGW3208fOADHcTcBCGVIqwDcPlAAn8/3JoBXyy0KoN9ut79xIABut9tARF8WiqmqWiz1htVqlfYNIEnSpwCa8n3b29sIh8OYmJhgy8vLiMfjyOVye1NPGgyGwVL1WbGgz+drJaJ72Pn2yWQSoVAIkUgE2WwWjDEsLDw6hyRJgizL4Hn+X1dGVdXOubm5P7R66IoBENHXAIR4PI5QKIRoNAoi0tQnEgkkEgmIoghZlqHX66s4jrsN4CWtHM0JeDye86urq9+Fw2Gsra0VTt4zgb0mCAJkWYbBYDg/MzPzfSGN5gTm5+dfXlpaKvRty7Z0Oo319XUYjcZ+AAUBNBfhyMjIOxaLxV5fX79YKYAgCKsmk+nM4uLiu1oaTQCPx3Omo6Pjr/HxcUtzc/NHkiQ9LLcxz/MZWZavrqysPFFbW7vU1/d8n5b2mFagp6dnjef5n/v7+xubmppuJJPJ6waDwZpKpdpUVWXAP2tgY2NjN4cxhurq6sl0Ot3Z0NAwabFYPuA4dm1rK/15LBbbLtRHcwJut/shEV1ijF3OZDL3rVbr2dHR0XONjY2nzWbz74z9d/2KorhYV1f3bCQSeaGtreU5UdTfBei6qtJ7s7OzW1p9im5ETqfzPhENAWhhjP3k9Xp/7Orqyvn9/s7W1ta3jx8/vsXz/JbRaByIRqMWk8mU6u3tGSXifgXwDMAGp6am7hbrUXQj2pkEJ0nSLwDO7rgyjLFv9Hr94PDwcHp2dpZsNluVKIougC5j96ZEk4HA1IsAiu7XJQEAQFGUE6qq3gNQs5vI2DKAj/1+P2MMXgAnH8Wwkc2qHdPT0yulapd1GjocjhUiupTvI6JTRHSHMdzJbw4AqoqBcpqXDQAATqfzBwDDpXRE+DYYDPrLrfu4V7IPARR7Bf0JoOStqWIAp9OZ5DjuAoBC/3QWYBeCweDmoQEAgMPhmGGMXft/hNyBQOC3x61X0cNkc3PzMyKazHMFzOYTX1RSqyIAt9utchx3EaAHAHug0+Uujo2NVX5sVmpDQ0Pv9/b2vrWfGn8D7B56Te6s/b8AAAAASUVORK5CYII="></button></td><td id="ltc"><button class="cryptodonate-btn">Donate<img src="data:image/png;base64,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"></button></td></tr></table></div></div><div class="sm:w-4/5"><div id="disqus_thread" identifier="breathe-new-life-into-2009-mac-pro" style="min-height:200px;"></div></div><!----><!----><!----></footer></article><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0"><p>For you from <a href="https://twitter.com/b34rd_tek" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">@b34rd_tek</a></p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"><li class="px-2"><a href="/" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300 active">Home</a></li><li class="px-2"><a href="/about/" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">About</a></li><li class="px-2"><a href="/sitemap.xml" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">Sitemap</a></li><li class="px-2"><a href="/feed.xml" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">RSS Feed</a></li></ul></nav></div></footer></main></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Breathe New Life into 2009 Mac Pro","path":"\u002Fbreathe-new-life-into-2009-mac-pro\u002F","slug":"breathe-new-life-into-2009-mac-pro","datetime":"2018-10-04 00:00:00","content":"\u003Cp\u003EThe Mac Pro circa 2009 is an amazing machine. The case is too damn beautiful to not show off and to be honest, the hardware isn’t a slouch either! It was and is a desktop server, with the dual Xeon processors from Intel and up to 128 GB of RAM (after you update the firmware) the machine can go a long way for a LONG time. I originally purchased this for development. At the time I was doing a LOT of mobile research on iOS and MacOS in general. The common denominator for testing and developing was the need for Apple hardware. The price tag in 2009 wasn’t too bad either, for $2500 I was able to score an Apple Display and the Mac Pro with an ATI Radeon HD 5770, Dual 2.26 Quad Core Xeons, and 16 GB of RAM. Even at 2009 prices, that’s a steal!\u003C\u002Fp\u003E\n\u003Cp\u003EFor easily two years this machine was a monster at every task I threw at it. Once I moved on to more Android-based security research I found MacOS was severely lacking. It was great for development but not for much else I did. This drove me to install Linux. I went with OpenSuSE because of the stability and how developer friendly it has always been (my opinion has since changed as I’m a die-hard Arch guy these days but that’s not the point here). Things were going great and research was rocking! Moving on another year or two life struck and kids happened. I was no longer able to spend evenings researching and the computer sat which brings me to today, 2018. I have a 9 (more like 10) year old computer that has the potential for new life. Here’s where we start…\u003C\u002Fp\u003E\n\u003Cp\u003EMy plan is to install Arch and make this beast into a KVM server. I’m going to upgrade the RAM to 128GB and host virtual machines for Node-Red, Web services, Motion, Home Assistant, Plex, NextCloud, and probably make one for a NAS, and possibly a few others. Let’s get started…\u003C\u002Fp\u003E\n\u003Cp\u003EFirst, we need to get a copy of Arch. Head over to archlinux.org\u002Fdownload and grab a copy of the latest iso.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*49sHvnr4p0Vy32d0Rl5IYA.png\" alt=\"alt text\" title=\"Arch Linux Download Page\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EMake sure after you’ve downloaded you verify the hash.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*2Ii7C0vqlMGjG8yV6u56MQ.png\" alt=\"alt text\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ENow we can either burn the iso to a disk or copy to flash drive. I prefer the flash route.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# dd if=\u002Fpath\u002Fto\u002Farchlinux.iso of=\u002Fdev\u002Fmy\u002Fusb\u002Fdevice bs=4M.\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EUpon completion, plug into the Mac, hold the option key, and boot up!\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*mrWs53QTngfpwNqlJy2shw.jpeg\" alt=\"alt text\" title=\"Hold Option Key while Booting\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIt may take a bit for the screen to display but eventually, you will get some boot options:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*IngJM5tr0MnAaAVHEQleEw.jpeg\" alt=\"alt text\" title=\"Boot Options\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EMake sure you select the disc or the USB device you loaded your Arch iso onto. From here we are brought to a root terminal and can begin our install. For those who have never used Arch Linux in the past, the wiki is amazing. It is probably the BEST documented of any distribution of Linux and will help you in every way. Based on what you want to accomplish, the wiki will guide you through the remainder of the install. You can see it here: \u003Ca href=\"https:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002Finstallation_guide\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fwiki.archlinux.org\u002Findex.php\u002Finstallation_guide\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ENow, we have network connectivity and have set our timezone. Time for us to get started. Since we’re going to install an LVM RAID, we need to turn on smartctl for our devices. Just open up your favorite editor (I prefer vim) and edit \u002Fetc\u002Fsmartd.conf. I added the following lines for my devices:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*Hmnl_3_YCxZwLhlMKUpFmA.png\" alt=\"alt text\" title=\"Adding devices to smartd\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ETime to partition and set up our RAID. Depending on your version of Arch and fdisk, it may be different and since these drives have been used in the past, I’m just going to delete all partitions and set them up as Linux filesystem type. We need to make sure to create a ~200MB partition for EFI. When we make the EFI partition, set the type to 1, EFI. After this is created, execute “fdisk \u002Fdev\u002Fsdx” for your device and delete partitions (minus your EFI partition), create a new primary partition, and set the partition type, then finally write the changes. You will need to do this for every device you are adding to your LVM RAID.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1470\u002F1*9oh7iRJerbkncyNTOdVM9w.png\" alt=\"alt text\" title=\"Creating our EFI filesystem\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EHere is where I start doing things a little differently than the install wiki. Now, I use LVM on the array to setup volume groups… From there, we install our base system and continue. To do this we run\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# pvcreate \u002Fdev\u002Fsdx, vgcreate VolGroup00 \u002Fdev\u002Fsdx. \u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWe will then verify everything with vgdisplay. After verifying we create our logical volume as raid 5 and use all the space available.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F552\u002F1*SC0hi8TdBwndc-5NFemSzA.png\" alt=\"alt text\" title=\"vgdisplay output\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F552\u002F1*ZFBV88S9LjDhly5ATd2ruA.png\" alt=\"alt text\" title=\"lvcreate\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*Hsz-w97H7_ywhpk3aJSMHA.png\" alt=\"alt text\" title=\"lvdisplay\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EFrom here we mount everything and run pacstrap with our base package selection. First we mount our arch-root to \u002Fmnt and our EFI to \u002Fmnt\u002Fboot. This is accomplished by executing:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# mount \u002Fdev\u002FVolGroup00\u002Farch-root \u002Fmnt\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# mkdir \u002Fmnt\u002Fboot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# mount \u002Fdev\u002Fsda1 \u002Fmnt\u002Fboot\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWe need to run pacstrap to get our base installed. You can add any package groups along with this command but I prefer to just install the base and then select individual packages with pacman in chroot step.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# pacstrap \u002Fmnt base \u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*1pE4Lm2kxW8ne6LqfC5evQ.png\" alt=\"alt text\" title=\"pacstrap installing base\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOnce complete, we generate our fstab.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# genfstab -U \u002Fmnt &gt;&gt; \u002Fmnt\u002Fetc\u002Ffstab’. \u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENow we go into our chroot and finish up.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# arch-chroot \u002Fmnt\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWe set our timezone, run hwclock, set locale, specify LANG and keymap. Then we configure networking and install our bootloader. These steps don’t differ from the Arch installation wiki until it comes to bootloader.\u003C\u002Fp\u003E\n\u003Cp\u003ESince this is a Mac we need to install intel-ucode package. This package is microcode for the processor. The BIOS updates will sort this out for you but, we aren’t able to update our bios. This is super important for us especially after spectre and meltdown updates were released.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*XO3wWmU94kBYtkXXEcAqYg.png\" alt=\"alt text\" title=\"install of intel-ucode package\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ELet’s go ahead and install all the KVM packages and requirements. We need to verify the kernel installed supports virtualization. We can check with:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# lsmod | grep kvm\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# lsmod | grep virtio\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# zgrep VIRTIO \u002Fproc\u002Fconfig.gz \u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*BIsyJYXnIzNGoeGAcawLKQ.png\" alt=\"alt text\" title=\"checking kvm status\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EFrom here we need to install the qemu package and libvirt package. I’m going with qemu-headless since this machine is going to run without a display and be managed remotely.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*R2g6T7zVqMoKGUwenaE4mA.png\" alt=\"alt text\" title=\"qemu installation\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOnce complete you will see a few additional packages suggested. If you feel the need for them, go for it. It all depends on your system. I installed samba as well as the qemu extras.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*GhGZvA36wVIp0SbLhBlM8g.png\" alt=\"alt text\" title=\"qemu extras\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe last thing I’m going to do is create a general user and setup sshd. To add my user, run:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# useradd -m -g users -G wheel,storage,power -s \u002Fbin\u002Fbash username\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# passwd username\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# pacman -S sudo\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# vi \u002Fetc\u002Fsudoers\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# uncomment the line below:\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #24292EFF\"\u003E%wheel ALL=(ALL) ALL\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENext, we need to install openssh.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# pacman -S openssh \u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #24292EFF\"\u003E - Next we edit our sshd config\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# vi \u002Fetc\u002Fssh\u002Fsshd_config\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EHere there are only a few things we need to specify, our listen address, listen port, users allowed, and to disable root login.\u003C\u002Fp\u003E\n\u003Cp\u003EAfter we make our edits we enable the service…\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# systemctl enable sshd.service\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F552\u002F1*OxWwK3vgM0liljAhMbvG0w.png\" alt=\"alt text\" title=\"install openssh\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F552\u002F1*wbFE_ECx8ktNIgjNboSW0w.png\" alt=\"alt text\" title=\"uncomment listen port and address\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*HHIZjZii-Xps2v0bcGMoww.png\" alt=\"alt text\" title=\"specify users and disable root in sshd\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ENow that we’ve finished all of this let’s setup the ramfs and our bootloader.\u003C\u002Fp\u003E\n\u003Cp\u003ETo begin we need to add some lvm items to \u002Fetc\u002Fmkinitcpio.conf.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# vi \u002Fetc\u002Fmkinitcpio.conf\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #24292EFF\"\u003E -- We need to add systemd and sd-lvm2 to the HOOKS section --\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #24292EFF\"\u003E -- We also need to add dm-raid raid0 raid1 raid10 raid456 to the MODULES section --\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*Xfg1uI5EpHAaWL2fT00hHg.png\" alt=\"alt text\" title=\"adding items to hooks\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOnce we save we can generate run:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# mkinitcpio -p linux\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ELastly, we install our systemd bootloader and configure it. This is done with two commands:\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #ffffff\"\u003E\u003Ccode\u003E\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# bootctl --path=\u002Fboot install\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"line\"\u003E\u003Cspan style=\"color: #C2C3C5\"\u003E# bootctl --path=\u002Fboot update\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EReboot and enjoy!\u003C\u002Fp\u003E\n\u003Cp\u003EArch can be a bit intense for an install but it is well worth it when finished.\u003C\u002Fp\u003E\n\u003Cp\u003EReferences:\nS.M.A.R.T. - ArchWiki\nS.M.A.R.T. (Self-Monitoring, Analysis, and Reporting Technology) is a supplementary component built into many modern…\nwiki.archlinux.org\nInstallation guide - ArchWiki\nThis document is a guide for installing Arch Linux from the live system booted with the official installation image…\nwiki.archlinux.org\nLVM - ArchWiki\nVirtual partitions allow addition and removal without worry of whether you have enough contiguous space on a particular…\nwiki.archlinux.org\nGRUB - ArchWiki\nGRUB (GRand Unified Bootloader) is a multi-boot loader. It is derived from PUPA which was a research project to develop…\nwiki.archlinux.org\nMicrocode - ArchWiki\nProcessor manufacturers release stability and security updates to the processor microcode. While microcode can be…\nwiki.archlinux.org\nEFI system partition - ArchWiki\nAccording to a Microsoft note[2], the minimum size for the EFI system partition (ESP) would be 100 MiB, though this is…\nwiki.archlinux.org\nMeltdown and Spectre\nMeltdown and Spectre exploit critical vulnerabilities in modern processors. These hardware vulnerabilities allow…\nmeltdownattack.com\nKVM - ArchWiki\nKVM, Kernel-based Virtual Machine, is a hypervisor built into the Linux kernel. It is similar to Xen in purpose but…\nwiki.archlinux.org\nQEMU - ArchWiki\nWhen used as a machine emulator, QEMU can run OSes and programs made for one machine (e.g. an ARM board) on a different…\nwiki.archlinux.org\u003C\u002Fp\u003E\n","description":"Taking an old Mac Pro from 2009 and repurposing with Arch and ZFS","timeToRead":7,"cover":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1400\u002F1*AV6cNtyNeiuQBfkxau3Z0A.jpeg","author":{"id":"b34rd","title":"b34rd","path":"\u002Fauthor\u002Fb34rd\u002F"},"tags":[{"id":"arch","title":"arch","path":"\u002Ftag\u002Farch\u002F"},{"id":"mac pro","title":"mac pro","path":"\u002Ftag\u002Fmac%20pro\u002F"},{"id":"zfs","title":"zfs","path":"\u002Ftag\u002Fzfs\u002F"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.49918c16.js" defer></script><script src="/assets/js/page--src--templates--post-vue.e0d89e50.js" defer></script>
  </body>
</html>
